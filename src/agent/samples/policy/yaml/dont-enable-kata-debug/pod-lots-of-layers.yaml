---
# This pod fails to start if Kata debug features are enabled.
# It starts successfully without Kata debug output.
#
# The policy generated by the genpolicy tool is also too large
# and therefore gets rejected by "kubectl apply".
apiVersion: v1
kind: Pod
metadata:
  name: debug-failing-many-layers
spec:
  terminationGracePeriodSeconds: 0
  restartPolicy: Never
  runtimeClassName: kata-cc
  containers:
    # 29 layers
    - name: azure-vote-front
      image: "mcr.microsoft.com/azuredocs/azure-vote-front:v1"
      command:
        - sh
        - "-c"
        - while true; do echo hello; sleep 10; done
    # 11 layers
    - name: footloose
      image: "quay.io/footloose/ubuntu18.04:latest"
      command:
        - sh
        - "-c"
        - while true; do echo go; sleep 25; done
    # 9 layers
    - name: bootloose
      image: "quay.io/k0sproject/bootloose-ubuntu22.04:latest"
      command:
        - sh
        - "-c"
        - while true; do echo go; sleep 25; done
    # 6 layers
    - name: nginx
      image: "mcr.microsoft.com/cbl-mariner/base/nginx:1.22.1-9-cm2.0.20230904-amd64"
      command:
        - sh
        - "-c"
        - while true; do echo nginx; sleep 10; done
    # 5 layers
    - name: redis
      image: "mcr.microsoft.com/oss/bitnami/redis:6.0.8"
      command:
        - sh
        - "-c"
        - while true; do echo redis; sleep 20; done
    # 4 layers
    - name: go
      image: "mcr.microsoft.com/appsvc/go:1.19-bullseye_20230324.1"
      command:
        - sh
        - "-c"
        - while true; do echo go; sleep 25; done
    # 4 layers
    - name: sysbench-kata
      image: "quay.io/kata-containers/sysbench-kata:latest"
      command:
        - sh
        - "-c"
        - while true; do echo go; sleep 25; done
